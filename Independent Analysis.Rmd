---
title: "CHEP898_Assignment4_Independent-Analysis-Part 1"
author: "Daoyi Huang"
date: "2026-02-22"
output: html_document
---

# 1. Identify a dataset

Since I am interested in cars, I chose a dataset about car prices prediction from the Kaggle website.     

**Data source:** The dataset used for this independent analysus was downloaded from the Kaggle website, titled Car Price Prediction Multiple Linear Regression.    

Link: https://www.kaggle.com/datasets/hellbuoy/car-price-prediction/data    

**Problem Statement (copied from the Kaggle website)**   

A Chinese automobile company Geely Auto aspires to enter the US market by setting up their manufacturing unit there and producing cars locally to give competition to their US and European counterparts.

They have contracted an automobile consulting company to understand the factors on which the pricing of cars depends. Specifically, they want to understand the factors affecting the pricing of cars in the American market, since those may be very different from the Chinese market. The company wants to know:

•Which variables are significant in predicting the price of a car   
•How well those variables describe the price of a car   

Based on various market surveys, the consulting firm has gathered a large data set of different types of cars across the America market.   

**Business Goal(copied from the Kaggle website)**        

We are required to model the price of cars with the available independent variables. It will be used by the management to understand how exactly the prices vary with the independent variables. They can accordingly manipulate the design of the cars, the business strategy etc. to meet certain price levels. Further, the model will be a good way for management to understand the pricing dynamics of a new market.     

Please Note : The dataset provided is for learning purpose. Please don’t draw any inference with real world scenario.   

**Sample size:**  The total sample size is 205.

**Variables** There are 26 columns identified, including ID and other 25 variables.   
1	Car_ID			Unique id of each observation (Interger)		
2	Symboling 			Its assigned insurance risk rating, A value of +3 indicates that the auto is risky, -3 that it is probably pretty safe.(Categorical) 		
3	carCompany			Name of car company (Categorical)		
4	fueltype			Car fuel type i.e gas or diesel (Categorical)		
5	aspiration			Aspiration used in a car (Categorical)		
6	doornumber			Number of doors in a car (Categorical)		
7	carbody			body of car (Categorical)		
8	drivewheel			type of drive wheel (Categorical)		
9	enginelocation			Location of car engine (Categorical)		
10	wheelbase			Weelbase of car (Numeric)		
11	carlength			Length of car (Numeric)		
12	carwidth			Width of car (Numeric)		
13	carheight			height of car (Numeric)		
14	curbweight			The weight of a car without occupants or baggage. (Numeric)		
15	enginetype			Type of engine. (Categorical)		
16	cylindernumber			cylinder placed in the car (Categorical)		
17	enginesize			Size of car (Numeric)		
18	fuelsystem			Fuel system of car (Categorical)		
19	boreratio			Boreratio of car (Numeric)		
20	stroke			Stroke or volume inside the engine (Numeric)		
21	compressionratio			compression ratio of car (Numeric)		
22	horsepower			Horsepower (Numeric)		
23	peakrpm			car peak rpm (Numeric)		
24	citympg			Mileage in city (Numeric)		
25	highwaympg			Mileage on highway (Numeric)		
26	price(Dependent variable)			Price of car (Numeric)		

**Missing data**  There is no missing data in this dataset.

**Limitation of this dataset**     
- Small sample size   
- The dataset provided is for learning purpose. I can not draw any inference with real world scenario.    
    

# 2. Statistical Methodology    
**My objective:** Build a car price prediction model in the United States, using clustering analysis, principal component analysis, and linear regression model.  

**Data Wrangling**    
• Data cleaning:    
  - Load the dataset and examine their structure (e.g., variables, data types, unique values).     
  - Identify outliers, exclude duplicates, and correct inconsistent formatting.       
•Descriptive analysis:   
  - Calculate mean, median, minimum, maximum, variance, and standard deviation for continuous variables; calculate frequency and percentage for categorical variables.     
  - Identify trends or anomalies based on these statistics.       
• Data Visualization:     
  - Bar chart     
  - Histograms
  - Boxplot     
  - Scatter plot      
**Potential variable selection**          
  - Correlation check   
  - Univariable univariate analysis   
**Model building**    
• Split dataset: trainging data (70%) testing data (30%)    
• **Model 1: Linear regression** (supervised learning)    
• **Model 2: Principal component analysis (PCA) + Linear regression** (unsupervised learning + supervised learning)      
  - Avoid multicollinearity among the features      
  - Reduce the dimension of the features    
  - Decide the number of components   
  - Visualize the key components on the plots       
  - Try to identify any meaningful theme for each component      
• **Model 3: Clustering analysis (KMeans) + linear regression** (unsupervised learning + supervised learning)     

**Model evaluation and comparison**     
Compare the three different machine learning method and select the best model       
- Diagnostic visulization (such as residuals plots and posterior predictive check plot)        
- coefficient determination (RSQ)     
- Root Mean Squared Error (RMSE)      

**Interpretation for the best model**    


# 3. Data Wrangling    
**load the library **  
**Import the can_path_data dataset**  
```{r setup}
library(tidyverse)
library(tidymodels)
library(reportRmd)
library(sjPlot)
library(plotly)
library(psych)
library(parallel)
library(finalfit)
library(gtsummary)
library(mlbench)
library(vip)
library(rsample)
library(tune)
library(recipes)
library(yardstick)
library(parsnip)
library(glmnet)
library(themis)
library(corrr)
library(performance)
library(utils)
library(see)
library(forestmodel)
data_carprice<-read.csv("/Users/xiehuangbao/Library/CloudStorage/OneDrive-UniversityofSaskatchewan/Study at USask/CHEP898_Machine Learning/Assignment/Final assignment/CHEP898_Assignment4_Independent-Analysis/CarPrice_Assignment.csv")
```

```{r}
glimpse(data_carprice)
```

There are 26 columns, including ID and other 25 variables.      

The total sample size is 205.     


```{r}
sum(duplicated(data_carprice))
```
There is no duplicated data existed in this dataset. 

**Identify the candidates of continuous variables: **     
- 1 output variable: car price (continuous)     
- 24 input variables (11 categorical variables + 13 continuous variables)   
**Categorical variables:**        
insurance risk rating   
Name of car company (Categorical)		    
Car fuel type i.e gas or diesel (Categorical)		  
Aspiration used in a car (Categorical)		
Number of doors in a car (Categorical)		
body of car (Categorical)		  
type of drive wheel (Categorical)       		
Location of car engine (Categorical)      
Type of engine. (Categorical)		    
cylinder placed in the car (Categorical)      
Fuel system of car (Categorical)    
**Continuouis variables:**    
Weelbase of car (Numeric)	  	  
Length of car (Numeric)		    
Width of car (Numeric)		    
height of car (Numeric)		  
The weight of a car without occupants or baggage. (Numeric)     		  
Size of car (Numeric)	      
Boreratio of car (Numeric)	  	    
Stroke or volume inside the engine (Numeric)      		
compression ratio of car (Numeric)		  
Horsepower (Numeric)		  
car peak rpm (Numeric)		  
Mileage in city (Numeric)		    
Mileage on highway (Numeric)		    

```{r}
rm_covsum(data=data_carprice,
covs = c('symboling', 'CarName', 'fueltype', 'aspiration', 'doornumber', 'carbody', 'drivewheel', 'enginelocation', 'enginetype', 'cylindernumber', 'fuelsystem', 
         'wheelbase', 'carlength', 'carwidth', 'carheight', 'curbweight', 'enginesize', 'boreratio', 'stroke', 'compressionratio', 'horsepower', 'peakrpm', 'citympg', 'highwaympg', 'price'))
```

  
There is not missing data.

```{r}
### The categorical variables were changed to factor.   
data_carprice$symboling <- as.factor(data_carprice$symboling)
data_carprice$CarName <- as.factor(data_carprice$CarName)
data_carprice$fueltype <- as.factor(data_carprice$fueltype)
data_carprice$aspiration <- as.factor(data_carprice$aspiration)
data_carprice$doornumber <- as.factor(data_carprice$doornumber)
data_carprice$carbody <- as.factor(data_carprice$carbody)
data_carprice$drivewheel <- as.factor(data_carprice$drivewheel)
data_carprice$enginelocation <- as.factor(data_carprice$enginelocation)
data_carprice$enginetype <- as.factor(data_carprice$enginetype)
data_carprice$cylindernumber <- as.factor(data_carprice$cylindernumber)
data_carprice$fuelsystem <- as.factor(data_carprice$fuelsystem)

glimpse(data_carprice)

```




